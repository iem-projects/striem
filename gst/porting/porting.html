<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="noindex,nofollow">

<title>Novacut/GStreamer1.0 - Ubuntu Wiki</title>
<script type="text/javascript" src="/moin_static192/common/js/common.js"></script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static192/light/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static192/light/css/print.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static192/light/css/msie.css">
<![endif]-->





<link rel="Start" href="/Home">
<link rel="Alternate" title="Wiki Markup" href="/Novacut/GStreamer1.0?action=raw">
<link rel="Alternate" media="print" title="Print View" href="/Novacut/GStreamer1.0?action=print">
<link rel="Up" href="/Novacut">
<link rel="Search" href="/FindPage">
<link rel="Index" href="/TitleIndex">
<link rel="Glossary" href="/WordIndex">
<link rel="Help" href="/HelpOnFormatting">
</head>

<body  lang="en" dir="ltr">
<div id="page" lang="en" dir="ltr">

<ul id="pagelocation">
<li><a href="/Novacut">Novacut</a></li><li><a class="backlink" href="/Novacut/GStreamer1.0?action=fullsearch&amp;context=180&amp;value=linkto%3A%22Novacut%2FGStreamer1.0%22" rel="nofollow" title="Click to do a full-text search for this title">GStreamer1.0</a></li>
</ul>
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line867"><a href="/Novacut">Novacut Wiki Home</a> &gt; <strong>GStreamer 1.0</strong> <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867"><em>Port your Python app to PyGI, Gtk3, and GStreamer 1.0!</em> <span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line862">GStreamer 1.0 packages are now available in <a class="http" href="http://packages.ubuntu.com/search?keywords=gstreamer1.0">Ubuntu Quantal</a>. For Ubuntu Precise (12.04 LTS) users, there are back-ported packages available in the <a class="https" href="https://launchpad.net/~gstreamer-developers/+archive/ppa?field.series_filter=precise">GStreamer developers PPA</a>. GnonLin and GES packages are not yet available for GStreamer 1.0 (but hopefully soon). <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line862">Although GStreamer 1.0 is <em>not</em> backward compatible with the GStreamer 0.10 series, it is parallel-installable. So you can safely install GStreamer 1.0 without effect on the many applications using GStreamer 0.10. <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line874">The focus here is porting Python apps. Also see: <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><ul><li><p class="line891"><a class="http" href="http://cgit.freedesktop.org/gstreamer/gstreamer/tree/docs/random/porting-to-1.0.txt">porting-to-1.0.txt (C Porting Guide)</a> <span class="anchor" id="line-12"></span></li><li><p class="line891"><a class="https" href="https://live.gnome.org/GnomeGoals/PortToGstreamer1">GNOME Goal: Port your application to GStreamer 1.0</a> <span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span></li></ul><p class="line867"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="#Adding_PPA_for_Ubuntu_Precise">Adding PPA for Ubuntu Precise</a></li><li>
<a href="#Installing_GStreamer_1.0_packages">Installing GStreamer 1.0 packages</a></li><li>
<a href="#Using_GStreamer_1.0_from_Python">Using GStreamer 1.0 from Python</a></li><li>
<a href="#Python_Porting_Guide">Python Porting Guide</a><ol><li>
<a href="#Examples">Examples</a></li><li>
<a href="#debian.2BAC8-control">debian/control</a></li><li>
<a href="#Imports">Imports</a></li><li>
<a href="#Gst.init.28.29">Gst.init()</a></li><li>
<a href="#element_factory_make.28.29">element_factory_make()</a></li><li>
<a href="#element_link_many.28.29">element_link_many()</a></li><li>
<a href="#Pipeline.add.28one.2C_two.29">Pipeline.add(one, two)</a></li><li>
<a href="#one.link.28two.2C_mycaps.29">one.link(two, mycaps)</a></li><li>
<a href="#STATE_PLAYING">STATE_PLAYING</a></li><li>
<a href="#SEEK_FLAG_FLUSH">SEEK_FLAG_FLUSH</a></li><li>
<a href="#FORMAT_TIME">FORMAT_TIME</a></li><li>
<a href="#prepare-xwindow-id">prepare-xwindow-id</a></li><li>
<a href="#GhostPad">GhostPad</a></li><li>
<a href="#Pad.get_caps.28.29">Pad.get_caps()</a></li><li>
<a href="#Element.get_pad.28.29">Element.get_pad()</a></li><li>
<a href="#Buffer.data">Buffer.data</a></li><li>
<a href="#Buffer.timestamp">Buffer.timestamp</a></li><li>
<a href="#Pad.get_negotiated_caps.28.29">Pad.get_negotiated_caps()</a></li><li>
<a href="#caps.5B0.5D">caps[0]</a></li><li>
<a href="#caps.5B0.5D.5B.27foo.27.5D">caps[0]['foo']</a></li><li>
<a href="#query_new_duration.28.29">query_new_duration()</a></li><li>
<a href="#audio.2BAC8-x-raw.2C_video.2BAC8-x-raw">audio/x-raw, video/x-raw</a></li><li>
<a href="#element_register.28.29">element_register()</a></li><li>
<a href="#PAD_SRC.2C_PAD_ALWAYS">PAD_SRC, PAD_ALWAYS</a></li><li>
<a href="#URIHandler">URIHandler</a></li><li>
<a href="#decodebin2">decodebin2</a></li><li>
<a href="#playbin2">playbin2</a></li><li>
<a href="#ffmpegcolorspace">ffmpegcolorspace</a></li><li>
<a href="#ffmpeg_.3D.3E_libav">ffmpeg =&gt; libav</a></li><li>
<a href="#gnlfilesource">gnlfilesource</a></li></ol></li></ol></li></ol></div> <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><p class="line867">
<h2 id="Adding_PPA_for_Ubuntu_Precise">Adding PPA for Ubuntu Precise</h2>
<span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><p class="line874">To use the back-ported packages for Ubuntu 12.04 LTS, add the GStreamer developers PPA like this: <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><pre><span class="anchor" id="line-1"></span>sudo apt-add-repository ppa:gstreamer-developers/ppa
<span class="anchor" id="line-2"></span>sudo apt-get update</pre><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span></li></ul><p class="line867">
<h2 id="Installing_GStreamer_1.0_packages">Installing GStreamer 1.0 packages</h2>
<span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><p class="line874">This should give you all the packages you likely want: <span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><pre><span class="anchor" id="line-1-1"></span>sudo apt-get install python-gi python3-gi \
<span class="anchor" id="line-2-1"></span>    gstreamer1.0-tools \
<span class="anchor" id="line-3"></span>    gir1.2-gstreamer-1.0 \
<span class="anchor" id="line-4"></span>    gir1.2-gst-plugins-base-1.0 \
<span class="anchor" id="line-5"></span>    gstreamer1.0-plugins-good \
<span class="anchor" id="line-6"></span>    gstreamer1.0-plugins-ugly \
<span class="anchor" id="line-7"></span>    gstreamer1.0-plugins-bad \
<span class="anchor" id="line-8"></span>    gstreamer1.0-libav</pre><span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span></li></ul><p class="line867">
<h2 id="Using_GStreamer_1.0_from_Python">Using GStreamer 1.0 from Python</h2>
<span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><p class="line874">You can use GStreamer 1.0 from Python (2 or 3) using PyGI like this: <span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><pre><span class="anchor" id="line-1-2"></span>&gt;&gt;&gt; import gi
<span class="anchor" id="line-2-2"></span>&gt;&gt;&gt; gi.require_version('Gst', '1.0')
<span class="anchor" id="line-3-1"></span>&gt;&gt;&gt; from gi.repository import Gst
<span class="anchor" id="line-4-1"></span>&gt;&gt;&gt; Gst.version()
<span class="anchor" id="line-5-1"></span>(1, 0, 0, 0)</pre><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span></li></ul><p class="line862">Although currently the default will be Gst 1.0 if available, it's still a good idea to <tt class="backtick">gi.require_version('Gst',&nbsp;'1.0')</tt> so that the code will clearly fail if Gst 1.0 isn't available. <span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><p class="line874">The biggest change for Python users will be using the introspected API rather than the static python-gst bindings. However, there are also API changes in GStreamer itself, although these changes are generally more subtle. <span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><p class="line867">
<h2 id="Python_Porting_Guide">Python Porting Guide</h2>
<span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><p class="line874">This is a guide to porting your PyGST app to GStreamer1.0 + PyGI. <span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><p class="line862">To whet your appetite, here's a simple (less than 100 lines) <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/video-player-0.10">PyGST video player</a>, and here's the <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/video-player-1.0">PyGI + GStreamer1.0 + Gtk3 port</a> of that same simple video player. <span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><p class="line862">Also see <a class="http" href="http://cgit.freedesktop.org/gstreamer/gstreamer/tree/docs/random/porting-to-1.0.txt">porting-to-1.0.txt</a>. Although from a C perspective, you can usually figure out the equivalent Python API fairly easily once you get the hang of PyGI. Some obscure features might still be broken or unavailable through PyGI, so if you end up digging into the C code, you'll want to read about <a class="https" href="https://live.gnome.org/GObjectIntrospection/Annotations">how the introspection annotations work</a>. <span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><p class="line862">Note that although you can <em>sort-of</em> use GStreamer0.10 with PyGI, key functionality is fundamentally broken and wont ever be fixed in GStreamer0.10 (because it would require API breakage). It's unproductive to try and first port to PyGI, then to GStreamer1.0. You should do both in one move. <span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><p class="line862">If your PyGST app is also a PyGTK app (fairly likely), you <em>must</em> port the Gtk bits to PyGI + Gtk3 at the same time. You <em>cannot</em> use PyGI and any of the static python-gobject based bindings together in the same process. <span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span><p class="line874">You just have to jump into the deep end and go for it! If you have extensive unit tests, pat yourself on the back, because you'll have a much easier time. <span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><p class="line862">On the upside, once you port to PyGI, it's generally very easy to port to <a href="/Python/3">Python3</a>. And you should, all the cool kids are doing it. <span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><p class="line867">
<h3 id="Examples">Examples</h3>
<span class="anchor" id="line-74"></span><span class="anchor" id="line-75"></span><p class="line874">Some small reference examples of common GStreamer use-cases, with both a 0.10 and a 1.0 version: <span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><div><table><tbody><tr>  <td><p class="line862"> Video Player: </td>
  <td><p class="line862"> <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/video-player-0.10">video-player-0.10</a> </td>
  <td><p class="line862"> <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/video-player-1.0">video-player-1.0</a> </td>
</tr>
<tr>  <td><span class="anchor" id="line-78"></span><p class="line862"> Webcam Capture: </td>
  <td><p class="line862"> <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/webcam-0.10">webcam-0.10</a> </td>
  <td><p class="line862"> <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/webcam-1.0">webcam-1.0</a> </td>
</tr>
<tr>  <td><span class="anchor" id="line-79"></span><p class="line862"> A/V Transcoder: </td>
  <td><p class="line862"> <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/transcoder-0.10">transcoder-0.10</a> </td>
  <td><p class="line862"> <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/transcoder-1.0">transcoder-1.0</a> </td>
</tr>
<tr>  <td><span class="anchor" id="line-80"></span><p class="line862"> Python Element: </td>
  <td><p class="line862"> <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/plugin-0.10">plugin-0.10</a> </td>
  <td><p class="line862"> <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/plugin-1.0">plugin-1.0</a> </td>
</tr>
</tbody></table></div><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><p class="line874">Grab all the example code and the sample video like this: <span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><pre><span class="anchor" id="line-1-3"></span>bzr branch lp:~jderose/+junk/gst-examples</pre><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span></li></ul><p class="line867">
<h3 id="debian.2BAC8-control">debian/control</h3>
<span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><p class="line862">You'll have to update your <tt class="backtick">debian/control</tt>, of course. So replace something like this: <span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><pre><span class="anchor" id="line-1-4"></span>Depends: python-gst0.10,
<span class="anchor" id="line-2-3"></span>    gstreamer0.10-plugins-good,
<span class="anchor" id="line-3-2"></span>    gstreamer0.10-plugins-ugly,
<span class="anchor" id="line-4-2"></span>    gstreamer0.10-plugins-bad,
<span class="anchor" id="line-5-2"></span>    gstreamer0.10-ffmpeg</pre><span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span></li></ul><p class="line874">With this: <span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span><span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span><span class="anchor" id="line-110"></span><pre><span class="anchor" id="line-1-5"></span>Depends: python-gi,
<span class="anchor" id="line-2-4"></span>    gir1.2-gstreamer-1.0,
<span class="anchor" id="line-3-3"></span>    gir1.2-gst-plugins-base-1.0,
<span class="anchor" id="line-4-3"></span>    gstreamer1.0-plugins-good,
<span class="anchor" id="line-5-3"></span>    gstreamer1.0-plugins-ugly,
<span class="anchor" id="line-6-1"></span>    gstreamer1.0-plugins-bad,
<span class="anchor" id="line-7-1"></span>    gstreamer1.0-libav</pre><span class="anchor" id="line-111"></span><span class="anchor" id="line-112"></span></li></ul><p class="line862">Then when you port to Python3, replace <strong>python-gi</strong> with <strong>python3-gi</strong>. <span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><p class="line867">
<h3 id="Imports">Imports</h3>
<span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><p class="line874">Replace: <span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span><span class="anchor" id="line-122"></span><pre><span class="anchor" id="line-1-6"></span>import gobject
<span class="anchor" id="line-2-5"></span>import gst</pre><span class="anchor" id="line-123"></span><span class="anchor" id="line-124"></span></li></ul><p class="line874">With: <span class="anchor" id="line-125"></span><span class="anchor" id="line-126"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span><span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><pre><span class="anchor" id="line-1-7"></span>import gi
<span class="anchor" id="line-2-6"></span>gi.require_version('Gst', '1.0')
<span class="anchor" id="line-3-4"></span>from gi.repository import GObject, Gst</pre><span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span></li></ul><p class="line874">After that a bit of search and replace (used with care) can help. Basically: <span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-135"></span><span class="anchor" id="line-136"></span><span class="anchor" id="line-137"></span><pre><span class="anchor" id="line-1-8"></span>gobject.* =&gt; GObject.*
<span class="anchor" id="line-2-7"></span>gst.* =&gt; Gst.*</pre><span class="anchor" id="line-138"></span><span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span></li></ul><p class="line867">
<h3 id="Gst.init.28.29">Gst.init()</h3>
<span class="anchor" id="line-141"></span><span class="anchor" id="line-142"></span><p class="line862">You should call <tt class="backtick">GObject.threads_init()</tt> in your module-scope, right after your imports. Unlike the static bindings, you also need to call <tt class="backtick">Gst.init()</tt>. So replace: <span class="anchor" id="line-143"></span><span class="anchor" id="line-144"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span><pre><span class="anchor" id="line-1-9"></span>gobject.threads_init()</pre><span class="anchor" id="line-147"></span><span class="anchor" id="line-148"></span></li></ul><p class="line874">With: <span class="anchor" id="line-149"></span><span class="anchor" id="line-150"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-151"></span><span class="anchor" id="line-152"></span><span class="anchor" id="line-153"></span><pre><span class="anchor" id="line-1-10"></span>GObject.threads_init()
<span class="anchor" id="line-2-8"></span>Gst.init(None)</pre><span class="anchor" id="line-154"></span><span class="anchor" id="line-155"></span><span class="anchor" id="line-156"></span></li></ul><p class="line867">
<h3 id="element_factory_make.28.29">element_factory_make()</h3>
<span class="anchor" id="line-157"></span><span class="anchor" id="line-158"></span><p class="line874">Replace: <span class="anchor" id="line-159"></span><span class="anchor" id="line-160"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-161"></span><span class="anchor" id="line-162"></span><pre><span class="anchor" id="line-1-11"></span>src = gst.element_factory_make('filesrc')</pre><span class="anchor" id="line-163"></span><span class="anchor" id="line-164"></span></li></ul><p class="line874">With: <span class="anchor" id="line-165"></span><span class="anchor" id="line-166"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-167"></span><span class="anchor" id="line-168"></span><pre><span class="anchor" id="line-1-12"></span>src = Gst.ElementFactory.make('filesrc', None)</pre><span class="anchor" id="line-169"></span><span class="anchor" id="line-170"></span></li></ul><p class="line862">Note that unlike <tt class="backtick">element_factory_make()</tt>, <tt class="backtick">ElementFactory.make()</tt> will return <tt class="backtick">None</tt> rather than raising an exception when the element is <em>not</em> found. <span class="anchor" id="line-171"></span><span class="anchor" id="line-172"></span><span class="anchor" id="line-173"></span><p class="line867">
<h3 id="element_link_many.28.29">element_link_many()</h3>
<span class="anchor" id="line-174"></span><span class="anchor" id="line-175"></span><p class="line862">There is no equivalent to <tt class="backtick">gst.element_link_many()</tt>, so replace: <span class="anchor" id="line-176"></span><span class="anchor" id="line-177"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-178"></span><span class="anchor" id="line-179"></span><pre><span class="anchor" id="line-1-13"></span>gst.element_link_many(one, two, three)</pre><span class="anchor" id="line-180"></span><span class="anchor" id="line-181"></span></li></ul><p class="line874">With: <span class="anchor" id="line-182"></span><span class="anchor" id="line-183"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-184"></span><span class="anchor" id="line-185"></span><span class="anchor" id="line-186"></span><pre><span class="anchor" id="line-1-14"></span>one.link(two)
<span class="anchor" id="line-2-9"></span>two.link(three)</pre><span class="anchor" id="line-187"></span><span class="anchor" id="line-188"></span><span class="anchor" id="line-189"></span></li></ul><p class="line867">
<h3 id="Pipeline.add.28one.2C_two.29">Pipeline.add(one, two)</h3>
<span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span><p class="line867"><tt class="backtick">Bin.add()</tt> can't be overloaded to add multiple elements at once, so replace: <span class="anchor" id="line-192"></span><span class="anchor" id="line-193"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-194"></span><span class="anchor" id="line-195"></span><span class="anchor" id="line-196"></span><pre><span class="anchor" id="line-1-15"></span>pipeline = gst.Pipeline()
<span class="anchor" id="line-2-10"></span>pipeline.add(one, two)</pre><span class="anchor" id="line-197"></span><span class="anchor" id="line-198"></span></li></ul><p class="line874">With: <span class="anchor" id="line-199"></span><span class="anchor" id="line-200"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-201"></span><span class="anchor" id="line-202"></span><span class="anchor" id="line-203"></span><span class="anchor" id="line-204"></span><pre><span class="anchor" id="line-1-16"></span>pipeline = Gst.Pipeline()
<span class="anchor" id="line-2-11"></span>pipeline.add(one)
<span class="anchor" id="line-3-5"></span>pipeline.add(two)</pre><span class="anchor" id="line-205"></span><span class="anchor" id="line-206"></span><span class="anchor" id="line-207"></span></li></ul><p class="line867">
<h3 id="one.link.28two.2C_mycaps.29">one.link(two, mycaps)</h3>
<span class="anchor" id="line-208"></span><span class="anchor" id="line-209"></span><p class="line874">Replace: <span class="anchor" id="line-210"></span><span class="anchor" id="line-211"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-212"></span><span class="anchor" id="line-213"></span><pre><span class="anchor" id="line-1-17"></span>one.link(two, mycaps)</pre><span class="anchor" id="line-214"></span><span class="anchor" id="line-215"></span></li></ul><p class="line874">With: <span class="anchor" id="line-216"></span><span class="anchor" id="line-217"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-218"></span><span class="anchor" id="line-219"></span><pre><span class="anchor" id="line-1-18"></span>one.link_filtered(two, mycaps)</pre><span class="anchor" id="line-220"></span><span class="anchor" id="line-221"></span><span class="anchor" id="line-222"></span></li></ul><p class="line867">
<h3 id="STATE_PLAYING">STATE_PLAYING</h3>
<span class="anchor" id="line-223"></span><span class="anchor" id="line-224"></span><p class="line874">Replace: <span class="anchor" id="line-225"></span><span class="anchor" id="line-226"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-227"></span><span class="anchor" id="line-228"></span><pre><span class="anchor" id="line-1-19"></span>pipeline.set_state(gst.STATE_PLAYING)</pre><span class="anchor" id="line-229"></span><span class="anchor" id="line-230"></span></li></ul><p class="line874">With: <span class="anchor" id="line-231"></span><span class="anchor" id="line-232"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-233"></span><span class="anchor" id="line-234"></span><pre><span class="anchor" id="line-1-20"></span>pipeline.set_state(Gst.State.PLAYING)</pre><span class="anchor" id="line-235"></span><span class="anchor" id="line-236"></span></li></ul><p class="line874">And so on. Some search-and-replace is helpful here, basically: <span class="anchor" id="line-237"></span><span class="anchor" id="line-238"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-239"></span><span class="anchor" id="line-240"></span><pre><span class="anchor" id="line-1-21"></span>gst.STATE_* =&gt; Gst.State.*</pre><span class="anchor" id="line-241"></span><span class="anchor" id="line-242"></span><span class="anchor" id="line-243"></span></li></ul><p class="line867">
<h3 id="SEEK_FLAG_FLUSH">SEEK_FLAG_FLUSH</h3>
<span class="anchor" id="line-244"></span><span class="anchor" id="line-245"></span><p class="line874">Replace something like this: <span class="anchor" id="line-246"></span><span class="anchor" id="line-247"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-248"></span><span class="anchor" id="line-249"></span><span class="anchor" id="line-250"></span><span class="anchor" id="line-251"></span><span class="anchor" id="line-252"></span><span class="anchor" id="line-253"></span><pre><span class="anchor" id="line-1-22"></span>pipeline.seek_simple(
<span class="anchor" id="line-2-12"></span>    gst.FORMAT_TIME,
<span class="anchor" id="line-3-6"></span>    gst.SEEK_FLAG_FLUSH | gst.SEEK_FLAG_KEY_UNIT,
<span class="anchor" id="line-4-4"></span>    nanoseconds
<span class="anchor" id="line-5-4"></span>)</pre><span class="anchor" id="line-254"></span><span class="anchor" id="line-255"></span></li></ul><p class="line874">With this: <span class="anchor" id="line-256"></span><span class="anchor" id="line-257"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-258"></span><span class="anchor" id="line-259"></span><span class="anchor" id="line-260"></span><span class="anchor" id="line-261"></span><span class="anchor" id="line-262"></span><span class="anchor" id="line-263"></span><pre><span class="anchor" id="line-1-23"></span>pipeline.seek_simple(
<span class="anchor" id="line-2-13"></span>    Gst.Format.TIME,
<span class="anchor" id="line-3-7"></span>    Gst.SeekFlags.FLUSH | Gst.SeekFlags.KEY_UNIT,
<span class="anchor" id="line-4-5"></span>    nanoseconds
<span class="anchor" id="line-5-5"></span>)</pre><span class="anchor" id="line-264"></span><span class="anchor" id="line-265"></span></li></ul><p class="line874">Search and replace: <span class="anchor" id="line-266"></span><span class="anchor" id="line-267"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-268"></span><span class="anchor" id="line-269"></span><pre><span class="anchor" id="line-1-24"></span>gst.SEEK_FLAG_* =&gt; Gst.SeekFlags.*</pre><span class="anchor" id="line-270"></span><span class="anchor" id="line-271"></span><span class="anchor" id="line-272"></span></li></ul><p class="line867">
<h3 id="FORMAT_TIME">FORMAT_TIME</h3>
<span class="anchor" id="line-273"></span><span class="anchor" id="line-274"></span><p class="line874">Search and replace: <span class="anchor" id="line-275"></span><span class="anchor" id="line-276"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-277"></span><span class="anchor" id="line-278"></span><pre><span class="anchor" id="line-1-25"></span>gst.FORMAT_* =&gt; Gst.Format.*</pre><span class="anchor" id="line-279"></span><span class="anchor" id="line-280"></span><span class="anchor" id="line-281"></span></li></ul><p class="line867">
<h3 id="prepare-xwindow-id">prepare-xwindow-id</h3>
<span class="anchor" id="line-282"></span><span class="anchor" id="line-283"></span><p class="line874">"prepare-xwindow-id" has been renamed "prepare-window-handle", and a few other details have changed (some on the PyGI + Gtk3 side). <span class="anchor" id="line-284"></span><span class="anchor" id="line-285"></span><p class="line874">So replace something like this: <span class="anchor" id="line-286"></span><span class="anchor" id="line-287"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-288"></span><span class="anchor" id="line-289"></span><span class="anchor" id="line-290"></span><span class="anchor" id="line-291"></span><span class="anchor" id="line-292"></span><span class="anchor" id="line-293"></span><pre><span class="anchor" id="line-1-26"></span>xid = drawingarea.window.xid
<span class="anchor" id="line-2-14"></span>
<span class="anchor" id="line-3-8"></span>def on_sync_message(bus, msg):
<span class="anchor" id="line-4-6"></span>    if msg.structure.get_name() == 'prepare-xwindow-id':
<span class="anchor" id="line-5-6"></span>        msg.src.set_xwindow_id(xid)</pre><span class="anchor" id="line-294"></span><span class="anchor" id="line-295"></span></li></ul><p class="line874">With this: <span class="anchor" id="line-296"></span><span class="anchor" id="line-297"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-298"></span><span class="anchor" id="line-299"></span><span class="anchor" id="line-300"></span><span class="anchor" id="line-301"></span><span class="anchor" id="line-302"></span><span class="anchor" id="line-303"></span><pre><span class="anchor" id="line-1-27"></span>xid = drawingarea.get_property('window').get_xid()
<span class="anchor" id="line-2-15"></span>
<span class="anchor" id="line-3-9"></span>def on_sync_message(bus, msg):
<span class="anchor" id="line-4-7"></span>    if msg.get_structure().get_name() == 'prepare-window-handle':
<span class="anchor" id="line-5-7"></span>        msg.src.set_window_handle(xid)</pre><span class="anchor" id="line-304"></span><span class="anchor" id="line-305"></span></li></ul><p class="line874">Note that trying to get the drawingarea XID in your on_sync_message() handler will cause a segfault because of threading issues. <span class="anchor" id="line-306"></span><span class="anchor" id="line-307"></span><p class="line862">Also note that for the above to work, you must have imported both <tt class="backtick">GdkX11</tt> and <tt class="backtick">GstVideo</tt>. So in your imports, make sure to include something like this: <span class="anchor" id="line-308"></span><span class="anchor" id="line-309"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-310"></span><span class="anchor" id="line-311"></span><span class="anchor" id="line-312"></span><pre><span class="anchor" id="line-1-28"></span># Needed for window.get_xid(), xvimagesink.set_window_handle(), respectively:
<span class="anchor" id="line-2-16"></span>from gi.repository import GdkX11, GstVideo</pre><span class="anchor" id="line-313"></span><span class="anchor" id="line-314"></span></li></ul><p class="line862">See this <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/video-player-1.0">video-player-1.0</a> script for a simple video player example. You might want to compare it to <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/video-player-0.10">video-player-0.10</a> to see how the same thing was done with python-gst. <span class="anchor" id="line-315"></span><span class="anchor" id="line-316"></span><span class="anchor" id="line-317"></span><p class="line867">
<h3 id="GhostPad">GhostPad</h3>
<span class="anchor" id="line-318"></span><span class="anchor" id="line-319"></span><p class="line862">You've got to use <tt class="backtick">GhostPad.new()</tt>. So replace: <span class="anchor" id="line-320"></span><span class="anchor" id="line-321"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-322"></span><span class="anchor" id="line-323"></span><pre><span class="anchor" id="line-1-29"></span>ghost = gst.GhostPad('sink', mysinkpad)</pre><span class="anchor" id="line-324"></span><span class="anchor" id="line-325"></span></li></ul><p class="line874">With: <span class="anchor" id="line-326"></span><span class="anchor" id="line-327"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-328"></span><span class="anchor" id="line-329"></span><pre><span class="anchor" id="line-1-30"></span>ghost = Gst.GhostPad.new('sink', mysinkpad)</pre><span class="anchor" id="line-330"></span><span class="anchor" id="line-331"></span><span class="anchor" id="line-332"></span></li></ul><p class="line867">
<h3 id="Pad.get_caps.28.29">Pad.get_caps()</h3>
<span class="anchor" id="line-333"></span><span class="anchor" id="line-334"></span><p class="line874">In callbacks for "pad-added" events and similar, it's common to use the string representation of the pad caps as a way to decide whether to link a pad and what to link the pad to. <span class="anchor" id="line-335"></span><span class="anchor" id="line-336"></span><p class="line862">You need to use <tt class="backtick">Pad.query_caps()</tt> instead of <tt class="backtick">Pad.get_caps()</tt>, and the returned object is no longer array-like. So in general replace this pattern: <span class="anchor" id="line-337"></span><span class="anchor" id="line-338"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-339"></span><span class="anchor" id="line-340"></span><span class="anchor" id="line-341"></span><span class="anchor" id="line-342"></span><span class="anchor" id="line-343"></span><pre><span class="anchor" id="line-1-31"></span>def on_pad_added(element, pad):
<span class="anchor" id="line-2-17"></span>    string = pad.get_caps()[0].get_name()
<span class="anchor" id="line-3-10"></span>    if string.startswith('audio/'):
<span class="anchor" id="line-4-8"></span>        &lt;link to some audio elements&gt;</pre><span class="anchor" id="line-344"></span><span class="anchor" id="line-345"></span></li></ul><p class="line874">With this: <span class="anchor" id="line-346"></span><span class="anchor" id="line-347"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-348"></span><span class="anchor" id="line-349"></span><span class="anchor" id="line-350"></span><span class="anchor" id="line-351"></span><span class="anchor" id="line-352"></span><pre><span class="anchor" id="line-1-32"></span>def on_pad_added(element, pad):
<span class="anchor" id="line-2-18"></span>    string = pad.query_caps(None).to_string()
<span class="anchor" id="line-3-11"></span>    if string.startswith('audio/'):
<span class="anchor" id="line-4-9"></span>        &lt;link to some audio elements&gt;</pre><span class="anchor" id="line-353"></span><span class="anchor" id="line-354"></span><span class="anchor" id="line-355"></span></li></ul><p class="line867">
<h3 id="Element.get_pad.28.29">Element.get_pad()</h3>
<span class="anchor" id="line-356"></span><span class="anchor" id="line-357"></span><p class="line867"><tt class="backtick">Element.get_pad()</tt> has been renamed <tt class="backtick">Element.get_static_pad()</tt>. So replace something like this: <span class="anchor" id="line-358"></span><span class="anchor" id="line-359"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-360"></span><span class="anchor" id="line-361"></span><span class="anchor" id="line-362"></span><pre><span class="anchor" id="line-1-33"></span>src = gst.element_factory_make('filesink')
<span class="anchor" id="line-2-19"></span>pad = src.get_pad('sink')</pre><span class="anchor" id="line-363"></span><span class="anchor" id="line-364"></span></li></ul><p class="line874">With this: <span class="anchor" id="line-365"></span><span class="anchor" id="line-366"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-367"></span><span class="anchor" id="line-368"></span><span class="anchor" id="line-369"></span><pre><span class="anchor" id="line-1-34"></span>src = Gst.ElementFactory.make('filesink', None)
<span class="anchor" id="line-2-20"></span>pad = src.get_static_pad('sink')</pre><span class="anchor" id="line-370"></span><span class="anchor" id="line-371"></span><span class="anchor" id="line-372"></span></li></ul><p class="line867">
<h3 id="Buffer.data">Buffer.data</h3>
<span class="anchor" id="line-373"></span><span class="anchor" id="line-374"></span><p class="line874">In a "preroll-handoff" or "handoff" callback, it's common to want access to the buffer data. A common use case is saving a JPEG thumbnail to a file, for example. <span class="anchor" id="line-375"></span><span class="anchor" id="line-376"></span><p class="line874">Replace something like this: <span class="anchor" id="line-377"></span><span class="anchor" id="line-378"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-379"></span><span class="anchor" id="line-380"></span><span class="anchor" id="line-381"></span><pre><span class="anchor" id="line-1-35"></span>def on_preroll_handoff(element, buf, pad):
<span class="anchor" id="line-2-21"></span>    data = buf.data</pre><span class="anchor" id="line-382"></span><span class="anchor" id="line-383"></span></li></ul><p class="line874">With this: <span class="anchor" id="line-384"></span><span class="anchor" id="line-385"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-386"></span><span class="anchor" id="line-387"></span><span class="anchor" id="line-388"></span><pre><span class="anchor" id="line-1-36"></span>def on_preroll_handoff(element, buf, pad):
<span class="anchor" id="line-2-22"></span>    data = buf.extract_dup(0, buf.get_size())</pre><span class="anchor" id="line-389"></span><span class="anchor" id="line-390"></span></li></ul><p class="line867">
<h3 id="Buffer.timestamp">Buffer.timestamp</h3>
<span class="anchor" id="line-391"></span><span class="anchor" id="line-392"></span><p class="line867"><tt class="backtick">Buffer.timestamp</tt> has been renamed to <tt class="backtick">Buffer.pts</tt> (Presentation Time Stamp). So replace something like this: <span class="anchor" id="line-393"></span><span class="anchor" id="line-394"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-395"></span><span class="anchor" id="line-396"></span><span class="anchor" id="line-397"></span><pre><span class="anchor" id="line-1-37"></span>def on_handoff(element, buf, pad):
<span class="anchor" id="line-2-23"></span>    timestamp = buf.timestamp</pre><span class="anchor" id="line-398"></span><span class="anchor" id="line-399"></span></li></ul><p class="line874">With this: <span class="anchor" id="line-400"></span><span class="anchor" id="line-401"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-402"></span><span class="anchor" id="line-403"></span><span class="anchor" id="line-404"></span><pre><span class="anchor" id="line-1-38"></span>def on_handoff(element, buf, pad):
<span class="anchor" id="line-2-24"></span>    timestamp = buf.pts</pre><span class="anchor" id="line-405"></span><span class="anchor" id="line-406"></span></li></ul><p class="line862">There is also the new <tt class="backtick">Buffer.dts</tt> (Decode Time Stamp). Often pts and dts will be the same, but B-frames are an example of when they'll be different. <span class="anchor" id="line-407"></span><span class="anchor" id="line-408"></span><span class="anchor" id="line-409"></span><p class="line867">
<h3 id="Pad.get_negotiated_caps.28.29">Pad.get_negotiated_caps()</h3>
<span class="anchor" id="line-410"></span><span class="anchor" id="line-411"></span><p class="line867"><tt class="backtick">Pad.get_negotiated_caps()</tt> has been renamed <tt class="backtick">Pad.get_current_caps()</tt>, so replace: <span class="anchor" id="line-412"></span><span class="anchor" id="line-413"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-414"></span><span class="anchor" id="line-415"></span><pre><span class="anchor" id="line-1-39"></span>caps = pad.get_negotiated_caps()</pre><span class="anchor" id="line-416"></span><span class="anchor" id="line-417"></span></li></ul><p class="line874">With: <span class="anchor" id="line-418"></span><span class="anchor" id="line-419"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-420"></span><span class="anchor" id="line-421"></span><pre><span class="anchor" id="line-1-40"></span>caps = pad.get_current_caps()</pre><span class="anchor" id="line-422"></span><span class="anchor" id="line-423"></span><span class="anchor" id="line-424"></span></li></ul><p class="line867">
<h3 id="caps.5B0.5D">caps[0]</h3>
<span class="anchor" id="line-425"></span><span class="anchor" id="line-426"></span><p class="line874">Caps objects are not array-like from PyGI, so replace: <span class="anchor" id="line-427"></span><span class="anchor" id="line-428"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-429"></span><span class="anchor" id="line-430"></span><pre><span class="anchor" id="line-1-41"></span>cap = caps[0]</pre><span class="anchor" id="line-431"></span><span class="anchor" id="line-432"></span></li></ul><p class="line874">With: <span class="anchor" id="line-433"></span><span class="anchor" id="line-434"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-435"></span><span class="anchor" id="line-436"></span><pre><span class="anchor" id="line-1-42"></span>cap = caps.get_structure(0)</pre><span class="anchor" id="line-437"></span><span class="anchor" id="line-438"></span><span class="anchor" id="line-439"></span></li></ul><p class="line867">
<h3 id="caps.5B0.5D.5B.27foo.27.5D">caps[0]['foo']</h3>
<span class="anchor" id="line-440"></span><span class="anchor" id="line-441"></span><p class="line874">Individual capability structures are not dictionary-like objects from PyGI, so you need to use type-appropriate accessor methods instead. For example, replace this: <span class="anchor" id="line-442"></span><span class="anchor" id="line-443"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-444"></span><span class="anchor" id="line-445"></span><span class="anchor" id="line-446"></span><span class="anchor" id="line-447"></span><pre><span class="anchor" id="line-1-43"></span>framerate = caps[0]['framerate']
<span class="anchor" id="line-2-25"></span>width = caps[0]['width']
<span class="anchor" id="line-3-12"></span>height = caps[0]['height']</pre><span class="anchor" id="line-448"></span><span class="anchor" id="line-449"></span></li></ul><p class="line874">With: <span class="anchor" id="line-450"></span><span class="anchor" id="line-451"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-452"></span><span class="anchor" id="line-453"></span><span class="anchor" id="line-454"></span><span class="anchor" id="line-455"></span><pre><span class="anchor" id="line-1-44"></span>(success, num, denom) = caps.get_structure(0).get_fraction('framerate')
<span class="anchor" id="line-2-26"></span>(success, width) = caps.get_structure(0).get_int('width')
<span class="anchor" id="line-3-13"></span>(success, height) = caps.get_structure(0).get_int('height')</pre><span class="anchor" id="line-456"></span><span class="anchor" id="line-457"></span><span class="anchor" id="line-458"></span></li></ul><p class="line867">
<h3 id="query_new_duration.28.29">query_new_duration()</h3>
<span class="anchor" id="line-459"></span><span class="anchor" id="line-460"></span><p class="line874">Replace: <span class="anchor" id="line-461"></span><span class="anchor" id="line-462"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-463"></span><span class="anchor" id="line-464"></span><pre><span class="anchor" id="line-1-45"></span>query = gst.query_new_duration(Gst.FORMAT_TIME)</pre><span class="anchor" id="line-465"></span><span class="anchor" id="line-466"></span></li></ul><p class="line874">With: <span class="anchor" id="line-467"></span><span class="anchor" id="line-468"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-469"></span><span class="anchor" id="line-470"></span><pre><span class="anchor" id="line-1-46"></span>query = Gst.Query.new_duration(Gst.Format.TIME)</pre><span class="anchor" id="line-471"></span><span class="anchor" id="line-472"></span><span class="anchor" id="line-473"></span></li></ul><p class="line867">
<h3 id="audio.2BAC8-x-raw.2C_video.2BAC8-x-raw">audio/x-raw, video/x-raw</h3>
<span class="anchor" id="line-474"></span><span class="anchor" id="line-475"></span><p class="line874">"audio/x-raw-int" and "audio/x-raw-float" have been condensed into a unified "audio/x-raw" with a flexible format description. <span class="anchor" id="line-476"></span><span class="anchor" id="line-477"></span><p class="line874">Likewise, "video/x-raw-yuv" and "video/x-raw-rgb" have been condensed into a unified "video/x-raw" with a flexible format description. <span class="anchor" id="line-478"></span><span class="anchor" id="line-479"></span><p class="line874">This is much nicer because in GStreamer 0.10 certain element details were leaked that really shouldn't have been. For example, if you wanted filter caps to force a certain sample-rate, you previously needed to know whether, say, an audio encoder took audio/x-raw-int or audio/x-raw-float. <span class="anchor" id="line-480"></span><span class="anchor" id="line-481"></span><p class="line874">So now you can replace say: <span class="anchor" id="line-482"></span><span class="anchor" id="line-483"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-484"></span><span class="anchor" id="line-485"></span><pre><span class="anchor" id="line-1-47"></span>caps = gst.caps_from_string('audio/x-raw-float, rate=(int)44100')</pre><span class="anchor" id="line-486"></span><span class="anchor" id="line-487"></span></li></ul><p class="line874">With: <span class="anchor" id="line-488"></span><span class="anchor" id="line-489"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-490"></span><span class="anchor" id="line-491"></span><pre><span class="anchor" id="line-1-48"></span>caps = Gst.caps_from_string('audio/x-raw, rate=(int)44100')</pre><span class="anchor" id="line-492"></span><span class="anchor" id="line-493"></span></li></ul><p class="line874">As you're only interested in specifying the rate anyway, it's much nicer to be truly abstracted from the format details. <span class="anchor" id="line-494"></span><span class="anchor" id="line-495"></span><span class="anchor" id="line-496"></span><p class="line867">
<h3 id="element_register.28.29">element_register()</h3>
<span class="anchor" id="line-497"></span><span class="anchor" id="line-498"></span><p class="line862">The <tt class="backtick">gst.element_register()</tt> function had some magic to create an in-process plugin on the fly if needed (assuming Jason understood this detail correctly when talking with Edward Hervey about it). <span class="anchor" id="line-499"></span><span class="anchor" id="line-500"></span><p class="line874">You can still register in-process elements with PyGI, but you need to use a bit more of the C API now and explicitly register your plugin, and then register your elements. So replace something like this: <span class="anchor" id="line-501"></span><span class="anchor" id="line-502"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-503"></span><span class="anchor" id="line-504"></span><span class="anchor" id="line-505"></span><pre><span class="anchor" id="line-1-49"></span>gobject.type_register(DmediaSrc)
<span class="anchor" id="line-2-27"></span>gst.element_register(DmediaSrc, 'dmediasrc')</pre><span class="anchor" id="line-506"></span><span class="anchor" id="line-507"></span></li></ul><p class="line874">With something like this: <span class="anchor" id="line-508"></span><span class="anchor" id="line-509"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-510"></span><span class="anchor" id="line-511"></span><span class="anchor" id="line-512"></span><span class="anchor" id="line-513"></span><span class="anchor" id="line-514"></span><span class="anchor" id="line-515"></span><span class="anchor" id="line-516"></span><span class="anchor" id="line-517"></span><span class="anchor" id="line-518"></span><span class="anchor" id="line-519"></span><span class="anchor" id="line-520"></span><span class="anchor" id="line-521"></span><span class="anchor" id="line-522"></span><span class="anchor" id="line-523"></span><span class="anchor" id="line-524"></span><span class="anchor" id="line-525"></span><span class="anchor" id="line-526"></span><span class="anchor" id="line-527"></span><span class="anchor" id="line-528"></span><span class="anchor" id="line-529"></span><pre><span class="anchor" id="line-1-50"></span>def plugin_init(plugin, userarg):
<span class="anchor" id="line-2-28"></span>    DmediaSrcType = GObject.type_register(DmediaSrc)
<span class="anchor" id="line-3-14"></span>    Gst.Element.register(plugin, 'dmediasrc', 0, DmediaSrcType)
<span class="anchor" id="line-4-10"></span>    return True
<span class="anchor" id="line-5-8"></span>
<span class="anchor" id="line-6-2"></span>version = Gst.version()
<span class="anchor" id="line-7-2"></span>Gst.Plugin.register_static_full(
<span class="anchor" id="line-8-1"></span>    version[0],  # GST_VERSION_MAJOR
<span class="anchor" id="line-9"></span>    version[1],  # GST_VERSION_MINOR
<span class="anchor" id="line-10"></span>    'dmedia',
<span class="anchor" id="line-11"></span>    'dmedia src plugin',
<span class="anchor" id="line-12"></span>    plugin_init,
<span class="anchor" id="line-13"></span>    '12.06',
<span class="anchor" id="line-14"></span>    'LGPL',
<span class="anchor" id="line-15"></span>    'dmedia',
<span class="anchor" id="line-16"></span>    'dmedia',
<span class="anchor" id="line-17"></span>    'https://launchpad.net/dmedia',
<span class="anchor" id="line-18"></span>    None,
<span class="anchor" id="line-19"></span>)</pre><span class="anchor" id="line-530"></span><span class="anchor" id="line-531"></span></li></ul><p class="line862">See <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/plugin-0.10">plugin-0.10</a> for an example python-gst plugin, and then <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/plugin-1.0">plugin-1.0</a> for how to do the same with PyGI and GSTreamer 1.0. <span class="anchor" id="line-532"></span><span class="anchor" id="line-533"></span><span class="anchor" id="line-534"></span><p class="line867">
<h3 id="PAD_SRC.2C_PAD_ALWAYS">PAD_SRC, PAD_ALWAYS</h3>
<span class="anchor" id="line-535"></span><span class="anchor" id="line-536"></span><p class="line874">Search and replace: <span class="anchor" id="line-537"></span><span class="anchor" id="line-538"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-539"></span><span class="anchor" id="line-540"></span><span class="anchor" id="line-541"></span><span class="anchor" id="line-542"></span><span class="anchor" id="line-543"></span><span class="anchor" id="line-544"></span><pre><span class="anchor" id="line-1-51"></span>gst.PAD_SRC =&gt; Gst.PadDirection.SRC
<span class="anchor" id="line-2-29"></span>gst.PAD_SINK =&gt; Gst.PadDirection.SINK
<span class="anchor" id="line-3-15"></span>gst.PAD_ALWAYS =&gt; Gst.PadPresence.ALWAYS
<span class="anchor" id="line-4-11"></span>gst.PAD_REQUEST =&gt; Gst.PadPresence.REQUEST
<span class="anchor" id="line-5-9"></span>gst.PAD_SOMETIMES =&gt; Gst.PadPresence.SOMETIMES</pre><span class="anchor" id="line-545"></span><span class="anchor" id="line-546"></span><span class="anchor" id="line-547"></span></li></ul><p class="line867">
<h3 id="URIHandler">URIHandler</h3>
<span class="anchor" id="line-548"></span><span class="anchor" id="line-549"></span><p class="line862">With PyGST, you can do something like this to implement the <a class="http" href="http://gstreamer.freedesktop.org/data/doc/gstreamer/head/gstreamer/html/gstreamer-GstUriHandler.html">GstUriHandler interface</a> in a custom element: <span class="anchor" id="line-550"></span><span class="anchor" id="line-551"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-552"></span><span class="anchor" id="line-553"></span><span class="anchor" id="line-554"></span><span class="anchor" id="line-555"></span><span class="anchor" id="line-556"></span><span class="anchor" id="line-557"></span><span class="anchor" id="line-558"></span><span class="anchor" id="line-559"></span><span class="anchor" id="line-560"></span><span class="anchor" id="line-561"></span><span class="anchor" id="line-562"></span><span class="anchor" id="line-563"></span><span class="anchor" id="line-564"></span><span class="anchor" id="line-565"></span><span class="anchor" id="line-566"></span><span class="anchor" id="line-567"></span><span class="anchor" id="line-568"></span><span class="anchor" id="line-569"></span><pre><span class="anchor" id="line-1-52"></span>class DmediaSrc(gst.Bin, gst.URIHandler):
<span class="anchor" id="line-2-30"></span>    @classmethod
<span class="anchor" id="line-3-16"></span>    def do_get_type_full(cls):
<span class="anchor" id="line-4-12"></span>        return gst.URI_SRC
<span class="anchor" id="line-5-10"></span>
<span class="anchor" id="line-6-3"></span>    @classmethod
<span class="anchor" id="line-7-3"></span>    def do_get_protocols_full(cls):
<span class="anchor" id="line-8-2"></span>        return ['dmedia']
<span class="anchor" id="line-9-1"></span>
<span class="anchor" id="line-10-1"></span>    def do_set_uri(self, uri):
<span class="anchor" id="line-11-1"></span>        if not uri.startswith('dmedia://'):
<span class="anchor" id="line-12-1"></span>            return False
<span class="anchor" id="line-13-1"></span>        self.uri = uri
<span class="anchor" id="line-14-1"></span>        return True
<span class="anchor" id="line-15-1"></span>
<span class="anchor" id="line-16-1"></span>    def do_get_uri(self):
<span class="anchor" id="line-17-1"></span>        return self.uri</pre><span class="anchor" id="line-570"></span><span class="anchor" id="line-571"></span></li></ul><p class="line862">(Note many details were left out above, see <a class="http" href="http://bazaar.launchpad.net/~jderose/+junk/gst-examples/view/head:/plugin-0.10">plugin-0.10</a> for the full working example.) <span class="anchor" id="line-572"></span><span class="anchor" id="line-573"></span><p class="line862">Currently it seems this isn't possible with PyGI + GStreamer 1.0. <a class="https" href="https://bugzilla.gnome.org/show_bug.cgi?id=679181">See bug 679181.</a> <span class="anchor" id="line-574"></span><span class="anchor" id="line-575"></span><span class="anchor" id="line-576"></span><p class="line867">
<h3 id="decodebin2">decodebin2</h3>
<span class="anchor" id="line-577"></span><span class="anchor" id="line-578"></span><p class="line874">The "decodebin2" element has been renamed to "decodebin", and the old "decodebin" element has been removed. <span class="anchor" id="line-579"></span><span class="anchor" id="line-580"></span><span class="anchor" id="line-581"></span><p class="line867">
<h3 id="playbin2">playbin2</h3>
<span class="anchor" id="line-582"></span><span class="anchor" id="line-583"></span><p class="line874">The "playbin2" element has been renamed to "playbin", and the old "playbin" element has been removed. <span class="anchor" id="line-584"></span><span class="anchor" id="line-585"></span><span class="anchor" id="line-586"></span><p class="line867">
<h3 id="ffmpegcolorspace">ffmpegcolorspace</h3>
<span class="anchor" id="line-587"></span><span class="anchor" id="line-588"></span><p class="line874">The "ffmpegcolorspace" element has been replaced with the new "videoconvert" element. <span class="anchor" id="line-589"></span><span class="anchor" id="line-590"></span><span class="anchor" id="line-591"></span><p class="line867">
<h3 id="ffmpeg_.3D.3E_libav">ffmpeg =&gt; libav</h3>
<span class="anchor" id="line-592"></span><span class="anchor" id="line-593"></span><p class="line862">All the major distros now ship the <a class="http" href="http://libav.org/">libav</a> fork of ffmpeg (and current GStreamer 0.10 packages build against libav, not ffmpeg). GStreamer 1.0 was an opportunity to do some renaming to reflect this change. <span class="anchor" id="line-594"></span><span class="anchor" id="line-595"></span><p class="line867"><a class="http" href="http://packages.ubuntu.com/search?keywords=gstreamer1.0-libav">gstreamer1.0-libav</a> is the equivalent of the the <a class="http" href="http://packages.ubuntu.com/search?keywords=gstreamer0.10-ffmpeg">gstreamer0.10-ffmpeg</a> Debian package. <span class="anchor" id="line-596"></span><span class="anchor" id="line-597"></span><p class="line862">Additionally, the GStreamer elements have been renamed. For example, in 1.0 use <strong>avdec_h264</strong> instead of <strong>ffdec_h264</strong>. Basically some search and replace: <span class="anchor" id="line-598"></span><span class="anchor" id="line-599"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-600"></span><span class="anchor" id="line-601"></span><span class="anchor" id="line-602"></span><span class="anchor" id="line-603"></span><span class="anchor" id="line-604"></span><span class="anchor" id="line-605"></span><pre><span class="anchor" id="line-1-53"></span>ffvideoscale =&gt; avvideoscale
<span class="anchor" id="line-2-31"></span>ffdec_* =&gt; avdec_*
<span class="anchor" id="line-3-17"></span>ffenc_* =&gt; avenc_*
<span class="anchor" id="line-4-13"></span>ffmux_* =&gt; avmux_*
<span class="anchor" id="line-5-11"></span>ffdemux_* =&gt; avdemux_*</pre><span class="anchor" id="line-606"></span><span class="anchor" id="line-607"></span></li></ul><p class="line862">To see all the elements shipped in the <tt class="backtick">gstreamer1.0-libav</tt> package, run: <span class="anchor" id="line-608"></span><span class="anchor" id="line-609"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-610"></span><span class="anchor" id="line-611"></span><pre><span class="anchor" id="line-1-54"></span>gst-inspect-1.0 libav</pre><span class="anchor" id="line-612"></span><span class="anchor" id="line-613"></span></li></ul><p class="line862">The equivalent command for <tt class="backtick">gstreamer0.10-ffmpeg</tt> is: <span class="anchor" id="line-614"></span><span class="anchor" id="line-615"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-616"></span><span class="anchor" id="line-617"></span><pre><span class="anchor" id="line-1-55"></span>gst-inspect-0.10 ffmpeg</pre><span class="anchor" id="line-618"></span><span class="anchor" id="line-619"></span><span class="anchor" id="line-620"></span></li></ul><p class="line867">
<h3 id="gnlfilesource">gnlfilesource</h3>
<span class="anchor" id="line-621"></span><span class="anchor" id="line-622"></span><p class="line874">The "gnlfilesource" element has been removed, so now use the "gnlurisource" element instead. <span class="anchor" id="line-623"></span><span class="anchor" id="line-624"></span><p class="line874">Replace: <span class="anchor" id="line-625"></span><span class="anchor" id="line-626"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-627"></span><span class="anchor" id="line-628"></span><span class="anchor" id="line-629"></span><pre><span class="anchor" id="line-1-56"></span>src = gst.element_factory_make('gnlfilesource')
<span class="anchor" id="line-2-32"></span>src.set_property('location', '/my/cool/video')</pre><span class="anchor" id="line-630"></span><span class="anchor" id="line-631"></span></li></ul><p class="line874">With: <span class="anchor" id="line-632"></span><span class="anchor" id="line-633"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-634"></span><span class="anchor" id="line-635"></span><span class="anchor" id="line-636"></span><pre><span class="anchor" id="line-1-57"></span>src = Gst.ElementFactory.make('gnlurisource')
<span class="anchor" id="line-2-33"></span>src.set_property('uri', 'file:///my/cool/video')</pre><span class="anchor" id="line-637"></span></li></ul><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" lang="en" dir="ltr">Novacut/GStreamer1.0  (last edited 2014-03-14 20:16:15 by <span title="jderose @ 173-14-15-225-Colorado.hfc.comcastbusiness.net[173.14.15.225]"><a class="interwiki" href="https://launchpad.net/~jderose" title="jderose @ 173-14-15-225-Colorado.hfc.comcastbusiness.net[173.14.15.225]">jderose</a></span>)</p>
<div id="pagebottom"></div>
</div>
</body>
</html>

